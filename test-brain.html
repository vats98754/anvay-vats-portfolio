<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Brain Model</title>
    <style>
        body { margin: 0; background: #222; color: white; font-family: Arial; }
        canvas { border: 2px solid #0BCEAF; margin: 20px; border-radius: 50%; }
        .info { padding: 20px; }
        .profile-test { 
            width: 400px; 
            height: 400px; 
            border: 3px solid #0BCEAF; 
            border-radius: 50%; 
            margin: 20px;
            background: #333;
        }
    </style>
</head>
<body>
    <div class="info">
        <h1>üß† Brain Model Test</h1>
        <p>Testing brain GLTF model loading and profile picture replacement...</p>
        <div id="status">Loading...</div>
    </div>
    
    <div class="profile-test">
        <div class="brain-profile" style="width: 100%; height: 100%; border-radius: 50%; background: #0BCEAF;"></div>
    </div>

    <!-- Three.js Libraries -->
    <script src="lib/three/three.min.js"></script>
    <script src="lib/three/GLTFLoader.js"></script>

    <script>
        console.log('üîç Testing Brain model loading...');
        
        const status = document.getElementById('status');
        
        if (typeof THREE === 'undefined') {
            status.innerHTML = '‚ùå Three.js not loaded';
        } else if (typeof THREE.GLTFLoader === 'undefined') {
            status.innerHTML = '‚ùå GLTFLoader not available';
        } else {
            status.innerHTML = '‚úÖ Libraries loaded, testing brain model...';
            
            // Test GLTF loading
            const loader = new THREE.GLTFLoader();
            loader.load(
                'assets/brain_point_cloud/scene.gltf',
                (gltf) => {
                    console.log('‚úÖ Brain model loaded successfully:', gltf);
                    status.innerHTML = '‚úÖ Brain model loaded successfully!';
                    
                    // Test profile picture replacement
                    testBrainProfile(gltf.scene);
                },
                (progress) => {
                    console.log('Loading progress:', (progress.loaded / progress.total * 100) + '%');
                    status.innerHTML = `Loading: ${Math.round(progress.loaded / progress.total * 100)}%`;
                },
                (error) => {
                    console.error('‚ùå Error loading Brain model:', error);
                    status.innerHTML = '‚ùå Error loading Brain model: ' + error.message;
                }
            );
        }
        
        function testBrainProfile(brainModel) {
            console.log('üß† Testing brain profile replacement...');
            
            const profileDiv = document.querySelector('.brain-profile');
            if (!profileDiv) {
                console.error('‚ùå Brain profile div not found');
                return;
            }
            
            // Create canvas
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 400;
            canvas.style.cssText = profileDiv.style.cssText;
            canvas.className = profileDiv.className;
            canvas.style.cursor = 'pointer';
            
            // Create Three.js scene for the canvas
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(50, 1, 0.1, 100);
            camera.position.set(0, 0, 15);
            
            const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
            renderer.setSize(400, 400);
            renderer.setClearColor(0x000000, 0);
            
            // Clone and setup brain
            const brain = brainModel.clone();
            brain.scale.set(4.5, 4.5, 4.5); // Increased size
            brain.position.set(0, 0, 0);
            
            // Lighting with brain-specific colors
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            const directionalLight1 = new THREE.DirectionalLight(0x0BCEAF, 0.6);
            const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
            directionalLight1.position.set(5, 5, 5);
            directionalLight2.position.set(-5, -5, 5);
            scene.add(ambientLight);
            scene.add(directionalLight1);
            scene.add(directionalLight2);
            scene.add(brain);
            
            // Replace div with canvas
            try {
                profileDiv.parentNode.replaceChild(canvas, profileDiv);
                console.log('‚úÖ Brain profile replaced with 3D canvas');
                
                // Animation loop
                function animate() {
                    brain.rotation.x += 0.005;
                    brain.rotation.y += 0.01;
                    brain.rotation.z += 0.003;
                    brain.position.y = Math.sin(Date.now() * 0.0008) * 0.2;
                    renderer.render(scene, camera);
                    requestAnimationFrame(animate);
                }
                animate();
                
                status.innerHTML += '<br>‚úÖ Interactive 3D brain profile created!';
                
            } catch (error) {
                console.error('‚ùå Error replacing brain profile:', error);
                status.innerHTML += '<br>‚ùå Error replacing brain profile: ' + error.message;
            }
        }
    </script>
</body>
</html>
