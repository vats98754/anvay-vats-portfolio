<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Northern Lights & Stars Test</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        #threejs-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            opacity: 1;
            pointer-events: none;
            background: transparent;
        }
        
        .info {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 5px;
            z-index: 1000;
            font-size: 14px;
        }
        
        .content {
            position: relative;
            z-index: 1;
            padding: 50px;
            color: white;
            text-align: center;
            margin-top: 200px;
        }
    </style>
</head>
<body>
    <canvas id="threejs-canvas"></canvas>
    
    <div class="info">
        <h3>üåå Northern Lights & Stars Test</h3>
        <p>‚ú® 3000 stars with spherical distribution</p>
        <p>üåà Animated aurora borealis shader</p>
        <p>üìú Scroll to see model revolution</p>
        <div id="status">Loading...</div>
    </div>
    
    <div class="content">
        <h1>Northern Lights Portfolio</h1>
        <p>Scroll down to see the GLTF models revolve around a central axis</p>
        <br><br><br><br><br><br><br><br><br><br>
        <h2>Test Section 1</h2>
        <p>Keep scrolling to see the revolution animation</p>
        <br><br><br><br><br><br><br><br><br><br>
        <h2>Test Section 2</h2>
        <p>The models should move in a circular pattern</p>
        <br><br><br><br><br><br><br><br><br><br>
        <h2>Test Section 3</h2>
        <p>Stars and northern lights should be visible throughout</p>
    </div>

    <!-- Three.js Library -->
    <script src="lib/three/three.min.js"></script>
    <script src="lib/three/GLTFLoader.js"></script>
    
    <script>
        // Simplified version of Portfolio3D for testing
        class TestPortfolio3D {
            constructor() {
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.renderer = null;
                this.stars = null;
                this.northernLights = null;
                
                this.setupRenderer();
                if (!this.renderer) return;
                
                this.setupCamera();
                this.createStarField();
                this.createNorthernLights();
                this.addEventListeners();
                this.animate();
                
                document.getElementById('status').textContent = '‚úÖ Initialized successfully!';
            }

            setupRenderer() {
                const canvas = document.getElementById('threejs-canvas');
                if (!canvas) {
                    console.error('‚ùå Canvas not found!');
                    return;
                }

                this.renderer = new THREE.WebGLRenderer({ 
                    canvas: canvas,
                    alpha: true, 
                    antialias: true 
                });
                
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setClearColor(0x000000, 0);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                
                console.log('‚úÖ Renderer setup complete');
            }

            setupCamera() {
                this.camera.position.set(0, 0, 10);
                this.camera.lookAt(0, 0, 0);
            }

            createStarField() {
                console.log('üåü Creating star field...');
                const starGeometry = new THREE.BufferGeometry();
                const starCount = 3000;
                const starPositions = new Float32Array(starCount * 3);
                const starColors = new Float32Array(starCount * 3);
                
                for (let i = 0; i < starCount; i++) {
                    const radius = Math.random() * 200 + 100;
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(Math.random() * 2 - 1);
                    
                    starPositions[i * 3] = radius * Math.sin(phi) * Math.cos(theta);
                    starPositions[i * 3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
                    starPositions[i * 3 + 2] = radius * Math.cos(phi);
                    
                    const intensity = Math.random() * 0.5 + 0.7;
                    starColors[i * 3] = intensity;
                    starColors[i * 3 + 1] = intensity;
                    starColors[i * 3 + 2] = Math.min(intensity + 0.2, 1.0);
                }
                
                starGeometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
                starGeometry.setAttribute('color', new THREE.BufferAttribute(starColors, 3));
                
                const starMaterial = new THREE.PointsMaterial({
                    size: 2,
                    sizeAttenuation: true,
                    vertexColors: true,
                    transparent: true,
                    opacity: 0.8
                });
                
                this.stars = new THREE.Points(starGeometry, starMaterial);
                this.scene.add(this.stars);
                console.log('‚úÖ Star field created with', starCount, 'stars');
            }

            createNorthernLights() {
                console.log('üåå Creating northern lights...');
                
                const auroraVertexShader = `
                    varying vec2 vUv;
                    void main() {
                        vUv = uv;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                    }
                `;

                const auroraFragmentShader = `
                    uniform float time;
                    varying vec2 vUv;
                    
                    void main() {
                        vec2 p = vUv * 3.0;
                        p.x += time * 0.1;
                        p.y += sin(time * 0.2) * 0.1;
                        
                        float wave1 = sin(p.y * 2.0 + time * 0.5) * 0.5 + 0.5;
                        float wave2 = sin(p.y * 3.0 + time * 0.3) * 0.3 + 0.7;
                        
                        float intensity = wave1 * wave2;
                        intensity = pow(intensity, 2.0);
                        
                        vec3 color1 = vec3(0.0, 1.0, 0.5);  // Green
                        vec3 color2 = vec3(0.0, 0.5, 1.0);  // Blue
                        vec3 aurora = mix(color1, color2, sin(p.y + time) * 0.5 + 0.5);
                        
                        float alpha = intensity * (1.0 - abs(vUv.y - 0.5) * 2.0);
                        alpha = smoothstep(0.0, 0.3, alpha);
                        
                        gl_FragColor = vec4(aurora, alpha * 0.6);
                    }
                `;

                const auroraGeometry = new THREE.PlaneGeometry(400, 100, 1, 1);
                const auroraMaterial = new THREE.ShaderMaterial({
                    vertexShader: auroraVertexShader,
                    fragmentShader: auroraFragmentShader,
                    uniforms: {
                        time: { value: 0 }
                    },
                    transparent: true,
                    blending: THREE.AdditiveBlending
                });

                const aurora = new THREE.Mesh(auroraGeometry, auroraMaterial);
                aurora.position.set(0, 20, -80);
                aurora.rotation.x = -0.3;
                this.scene.add(aurora);

                this.northernLights = { aurora: aurora };
                console.log('‚úÖ Northern lights created');
            }

            addEventListeners() {
                window.addEventListener('resize', () => {
                    this.camera.aspect = window.innerWidth / window.innerHeight;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(window.innerWidth, window.innerHeight);
                });
            }

            animate() {
                requestAnimationFrame(() => this.animate());
                
                const time = Date.now() * 0.001;
                
                // Update northern lights
                if (this.northernLights && this.northernLights.aurora.material.uniforms) {
                    this.northernLights.aurora.material.uniforms.time.value = time;
                }
                
                // Subtle star rotation
                if (this.stars) {
                    this.stars.rotation.y += 0.0001;
                }
                
                if (this.renderer) {
                    this.renderer.render(this.scene, this.camera);
                }
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof THREE !== 'undefined') {
                console.log('üöÄ Three.js available, initializing test...');
                new TestPortfolio3D();
            } else {
                console.error('‚ùå Three.js not available');
                document.getElementById('status').textContent = '‚ùå Three.js not loaded';
            }
        });
    </script>
</body>
</html>
